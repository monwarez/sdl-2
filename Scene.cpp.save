#include "Scene.h"

CScene::CScene()
{
    m_pShader   =   new Shader("Shaders/texture.vert","Shaders/texture.frag");
    m_pShader->charger();
    m_uniformMatrix.modelview   =   glm::mat4(1);
    m_uniformMatrix.projection  =   glm::perspective(70.0, 1024/768.0, 0.01,100.0);
    m_pCInput                   =   0;
    m_pCamera                   =   new Camera(glm::vec3(-1,-1,1),glm::vec3(0,0,0),glm::vec3(0,0,1));

}
CScene::~CScene()
{
    delete m_pShader;
    delete m_pCamera;
    /*  On ne delete pas les objets
    for (unsigned int i=0; i < m_pObject.size(); ++i)
        delete m_pObject[i];
        */

}
void    CScene::Show()
{

    GLuint shaderID =   m_pShader->getProgramID();
    // camera
    m_pCamera->keyBoardEvent(CIn)
    m_pCamera->lookAt(m_uniformMatrix.modelview);
    glUseProgram(shaderID);
        m_uniformMatrix.modelviewLocation   =   glGetUniformLocation(shaderID, "modelview");
        m_uniformMatrix.mvpLocation         =   glGetUniformLocation(shaderID,"modelviewprojection");



        for (unsigned int i=0; i < m_pObject.size(); ++i)
        {
            m_pObject[0]->Show(m_uniformMatrix);
        }
    glUseProgram(0);


}
void    CScene::AttachObject(IObject *objet)
{
    m_pObject.push_back(objet);
}
void    CScene::AttachInput(CInput  *input)
{
    m_pCInput   =   input;
}
